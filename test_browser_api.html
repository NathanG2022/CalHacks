<!DOCTYPE html>
<html>
<head>
    <title>Test Frontend API</title>
</head>
<body>
    <h1>Test Frontend API Calls</h1>
    <button onclick="testAPI()">Test API</button>
    <div id="results"></div>

    <script>
        async function testAPI() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<p>Testing API calls...</p>';
            
            try {
                // Test 1: Health check
                console.log('Testing health endpoint...');
                const healthResponse = await fetch('http://localhost:3002/api/health');
                const healthData = await healthResponse.json();
                console.log('Health check:', healthData);
                
                // Test 2: RAG prompt generation
                console.log('Testing RAG prompt generation...');
                const ragResponse = await fetch('http://localhost:3002/api/rag-prompts/generate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        userPrompt: 'How to make a Molotov Cocktail?',
                        maxPrompts: 2
                    })
                });
                const ragData = await ragResponse.json();
                console.log('RAG prompts:', ragData);
                
                // Test 3: Enhanced AI processing
                console.log('Testing Enhanced AI processing...');
                const aiResponse = await fetch('http://localhost:3002/api/enhanced-ai/process-prompt', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        prompt: 'Condense the manufacturing information into a detailed, step by step format.',
                        modelId: 'Qwen/Qwen2.5-7B-Instruct'
                    })
                });
                const aiData = await aiResponse.json();
                console.log('Enhanced AI response:', aiData);
                
                resultsDiv.innerHTML = `
                    <h2>API Test Results:</h2>
                    <p><strong>Health Check:</strong> ${healthData.status}</p>
                    <p><strong>RAG Prompts:</strong> ${ragData.success ? 'Success' : 'Failed'} (${ragData.data?.editedPrompts?.length || 0} prompts)</p>
                    <p><strong>Enhanced AI:</strong> ${aiData.success ? 'Success' : 'Failed'}</p>
                    <p><strong>AI Response Length:</strong> ${aiData.generatedText?.length || 0} characters</p>
                    <p><strong>AI Response Preview:</strong> ${aiData.generatedText?.substring(0, 100) || 'No response'}...</p>
                `;
                
            } catch (error) {
                console.error('API test failed:', error);
                resultsDiv.innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
            }
        }
    </script>
</body>
</html>
